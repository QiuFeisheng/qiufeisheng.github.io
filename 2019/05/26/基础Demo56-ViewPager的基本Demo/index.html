<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="1、activity_guide.xml&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;utf-8&amp;quot;?&amp;gt; &amp;lt;RelativeLayout xmlns:android=&amp;quot;http://schemas.android.com/apk/res/android&amp;quot; android:id=&amp;quot;@+id/activ">
<meta property="og:type" content="article">
<meta property="og:title" content="基础Demo56-ViewPager的基本Demo">
<meta property="og:url" content="http://yoursite.com/2019/05/26/基础Demo56-ViewPager的基本Demo/index.html">
<meta property="og:site_name" content="QiuFeisheng&#39;Blog">
<meta property="og:description" content="1、activity_guide.xml&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;utf-8&amp;quot;?&amp;gt; &amp;lt;RelativeLayout xmlns:android=&amp;quot;http://schemas.android.com/apk/res/android&amp;quot; android:id=&amp;quot;@+id/activ">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-05-29T09:08:32.359Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="基础Demo56-ViewPager的基本Demo">
<meta name="twitter:description" content="1、activity_guide.xml&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;utf-8&amp;quot;?&amp;gt; &amp;lt;RelativeLayout xmlns:android=&amp;quot;http://schemas.android.com/apk/res/android&amp;quot; android:id=&amp;quot;@+id/activ">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2019/05/26/基础Demo56-ViewPager的基本Demo/">





  <title>基础Demo56-ViewPager的基本Demo | QiuFeisheng'Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">QiuFeisheng'Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/26/基础Demo56-ViewPager的基本Demo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="QiuFeisheng">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="QiuFeisheng'Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">基础Demo56-ViewPager的基本Demo</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-05-26T00:00:00+08:00">
                2019-05-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="1、activity-guide-xml"><a href="#1、activity-guide-xml" class="headerlink" title="1、activity_guide.xml"></a>1、activity_guide.xml</h3><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
android:id=&quot;@+id/activity_guide&quot;
android:layout_width=&quot;match_parent&quot;
android:layout_height=&quot;match_parent&quot;&gt;

&lt;android.support.v4.view.ViewPager
    android:id=&quot;@+id/viewpager_guide&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;&gt;
&lt;/android.support.v4.view.ViewPager&gt;


&lt;Button
    android:id=&quot;@+id/btn_start_main&quot;
    android:background=&quot;@drawable/btn_start_main_selector&quot;
    android:textColor=&quot;@drawable/btn_start_main_text_selector&quot;
    android:text=&quot;开始体验&quot;
    android:paddingLeft=&quot;20sp&quot;
    android:paddingRight=&quot;20sp&quot;
    android:visibility=&quot;gone&quot;
    android:layout_marginBottom=&quot;80dp&quot;
    android:layout_alignParentBottom=&quot;true&quot;
    android:layout_centerHorizontal=&quot;true&quot;
    android:layout_width=&quot;wrap_content&quot;
    android:layout_height=&quot;wrap_content&quot; /&gt;

&lt;RelativeLayout
    android:layout_marginBottom=&quot;40dp&quot;
    android:layout_alignParentBottom=&quot;true&quot;
    android:layout_centerHorizontal=&quot;true&quot;
    android:layout_width=&quot;wrap_content&quot;
    android:layout_height=&quot;wrap_content&quot;&gt;

    &lt;LinearLayout
        android:id=&quot;@+id/ll_point_group&quot;
        android:orientation=&quot;horizontal&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        /&gt;

    &lt;ImageView
        android:id=&quot;@+id/iv_red_point&quot;
        android:layout_width=&quot;10dp&quot;
        android:layout_height=&quot;10dp&quot;
        android:background=&quot;@drawable/point_red&quot;
        /&gt;
&lt;/RelativeLayout&gt;

&lt;/RelativeLayout&gt;
</code></pre><h3 id="2、GuideActivity-java"><a href="#2、GuideActivity-java" class="headerlink" title="2、GuideActivity.java"></a>2、GuideActivity.java</h3><pre><code>import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.support.v4.view.PagerAdapter;
import android.support.v4.view.ViewPager;
import android.util.Log;
import android.view.View;
import android.view.ViewGroup;
import android.view.ViewTreeObserver;
import android.widget.Button;
import android.widget.ImageView;
import android.widget.LinearLayout;
import android.widget.RelativeLayout;
import com.example.newbeijing.R;
import com.example.newbeijing.SplashActivity;
import com.example.newbeijing.utils.CacheUtil;
import com.example.newbeijing.utils.DensityUtil;
import java.util.ArrayList;

/**
 * 面向对象的本质：构造对象，调用象方
 */
public class GuideActivity extends Activity {

//两灰色点的间距声明
private int leftMax;
//存放10dp转为px后的值，用于动态设置灰色点point的大小也是声明
private int width;

//view声明
private ViewPager viewpager_guide;
private Button btn_start_main;
private LinearLayout ll_point_group;
private ArrayList&lt;ImageView&gt; imageViews;
private ImageView iv_red_point;


//继承重写Activity的生命周期方法：onCreate()，且super先调用父类的onCreate做一些初始化操作吧（可查一下）
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    //初始化view
    initView();

    //初始化数据
    initData();


    //把Data填充到view显示出来
    setData();

}

//初始化view
private void initView() {

    //将layout初始化成主view
    setContentView(R.layout.activity_guide);

    //初始化view对象
    viewpager_guide = (ViewPager) findViewById(R.id.viewpager_guide);
    btn_start_main = (Button) findViewById(R.id.btn_start_main);
    ll_point_group = (LinearLayout) findViewById(R.id.ll_point_group);
    iv_red_point = (ImageView) findViewById(R.id.iv_red_point);
}

//初始化Data
private void initData() {

    //初始化Data：ViewPager的数据
    // 初始化ImageView对象集合，等等添加值
    imageViews=new ArrayList&lt;&gt;();

    //初始化Data：将drawable图片转化成int数组
    int[] ids=new int[]{
            R.drawable.guide_1,
            R.drawable.guide_2,
            R.drawable.guide_3
    };

    //初始化Data：准备好ViewPager数据
    for (int i=0;i&lt;ids.length;i++){
        //构造局部ImageView对象
        ImageView imageView=new ImageView(this);
        //imageView对象调用setter初始化内部值
        imageView.setBackgroundResource(ids[i]);

        //imageView集合的对象调用象方初始化内部值
        imageViews.add(imageView);


        //构造局部ImageView对象,准备好灰色点的数据
        ImageView point=new ImageView(this);
        //imageView对象调用setter初始化内部值
        //值是自定义的drawable xml文件
        point.setBackgroundResource(R.drawable.point_normal);

        //调用象方得到10dp的px值
        width= DensityUtil.dip2px(this,10);

        //构造LayoutParams对象，用于设置layout内部的布局参数
        LinearLayout.LayoutParams params=new LinearLayout.LayoutParams(width,width);
        if (i!=0){
            //调用象方初始化属性值
            params.leftMargin=width;
        }
        point.setLayoutParams(params);
        //将Data添加到view显示出来，view也是Data的一种类型
        ll_point_group.addView(point);
    }
}


//填充数据到view，显示出来，大多数是依靠适配器和监听接口
private void setData() {

    //填充Data到view显示出来：传入view的数据整理类adapter
    // 适配器adapter应该理解为数据整理类
    //真正显示view的方法是内置在ViewPager内部的，adapter只是整理好数据到对象方法里面
    //让view内部去调用adapter的象方，就显示出来了
    //正确理解adapter:数据整理类，数据写到象方，给view内部调用象方，显示成view
    viewpager_guide.setAdapter(new MyPagerAdapter());

    //红点移动=两灰色点间距*临时屏幕滑动百分比,所以要求 两灰色点间距  屏幕百分比
    //用视图树的根节点监听和和view绘制过程中的回调象方来获取 两灰色点间距
    iv_red_point.getViewTreeObserver().addOnGlobalLayoutListener(new MyOnGlobalLayoutListener());

    //将Data填充到view显示出来：传入viewPager页面改变监听结果的处理类对象，回调象方处理
    viewpager_guide.addOnPageChangeListener(new MyOnPageChangeListener());

    //将Data填充到view显示出来：传入Button的点击监听结果的处理类对象，回调处理监听结果
    btn_start_main.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            //用缓存类保存进入过主页面
            CacheUtil.putBoolean(GuideActivity.this, SplashActivity.START_MAIN,true);

            // 跳转到MainActivity
            Intent intent=new Intent(GuideActivity.this,MainActivity.class);
            startActivity(intent);

            //
            finish();
        }
    });
}




//adapter是ViewPager的数据整理类，把数据整理写到象方
// 然后在ViewPager内部的View显示方法里调用此象方
class MyPagerAdapter extends PagerAdapter{

    /**
     * 返回数据的总个数,即就是ViewPager的页面个数
     * @return
     */
    @Override
    public int getCount() {
        // return 3;也行
        return imageViews.size();
    }

    /**
     *
     * @param container container就是ViewPager；
     *  因为ViewPager是view，所以它也是一个容器
     * @param position  要创建页面的位置；
     * @return  返回和创建当前页面右关系的值；
     */
    @Override
    public Object instantiateItem(ViewGroup container, int position) {
        ImageView imageView=imageViews.get(position);
        container.addView(imageView);
        return imageView; //作为下面isViewFromObject的object参数
    }

    /**
     * 销毁页面
     * @param container ViewPager
     * @param position  要页面的位置
     * @param object  要销毁的页面
     */
    @Override
    public void destroyItem(ViewGroup container, int position, Object object) {
        //super.destroyItem(container, position, object);默认注销，否则会崩溃
        container.removeView((View) object); //把object指定成View类型
    }

    /**
     * 此方法是要判断当前创建的视图和返回的页面是不是一样
     * @param view 当前创建的视图
     * @param object 上面instantiateItem返回的结果值
     * @return
     */
    @Override
    public boolean isViewFromObject(View view, Object object) {
        return view==object;
    }
}


/**
 * 同于回调象方拿到两灰色点间距
 */
class MyOnGlobalLayoutListener implements ViewTreeObserver.OnGlobalLayoutListener {

    @Override
    public void onGlobalLayout() {
        //因为我们只需要执行一次就可以获得间距，就不需要多次执行，所以监听完先remove掉
        //这就是提高性能的细节处理*******************非常重要*********
        iv_red_point.getViewTreeObserver().removeGlobalOnLayoutListener(this);
        leftMax=ll_point_group.getChildAt(1).getLeft()-ll_point_group.getChildAt(0).getLeft();
    }
}


/**
 * ViewPager页面滑动监听结果的处理类，传到ViewPager内部进行回调该象方
 */
class MyOnPageChangeListener implements ViewPager.OnPageChangeListener {
    /**
     * 当屏幕滑动的时候会回调此方法
     * @param position 代表当前滑动的是哪一张页面
     * @param positionOffset 页面滑动百分比==屏幕滑动百分比
     * @param positionOffsetPixels 滑动的像素
     */
    @Override
    public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) {

        //红点移动的距离==两灰色点间距*屏幕百分比 leftMax是两灰色点的间距 leftmagin就是红点最终坐标
        //红点的坐标==原始坐标+滑动坐标
        int leftmargin= (int) (position*leftMax+(leftMax*positionOffset));
        //因为iv_red_point是写在layout中的，所以要getLayoutParams(),别模仿灰色点的写法，不过原理是一样的
        RelativeLayout.LayoutParams params=(RelativeLayout.LayoutParams)iv_red_point.getLayoutParams();
        params.leftMargin=leftmargin;
        //红点调用象方设置自己的布局属性
        iv_red_point.setLayoutParams(params);

    }

    /**
     * 当页面被选中的时候调用
     * @param position
     */
    @Override
    public void onPageSelected(int position) {

        if (position==imageViews.size()-1){
            btn_start_main.setVisibility(View.VISIBLE);
        }else{
            btn_start_main.setVisibility(View.GONE);
        }
    }

    /**
     * 当页面状态改变的时候回调此方法： 静止 拖拽 惯性 总共3种状态
     * @param state
     */
    @Override
    public void onPageScrollStateChanged(int state) {


                }
        }

}
</code></pre>
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/05/25/基础Demo55-基本动画Demo/" rel="next" title="基础Demo55-基本动画Demo">
                <i class="fa fa-chevron-left"></i> 基础Demo55-基本动画Demo
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/05/27/基础Demo57-简单的自定义View（1）/" rel="prev" title="基础Demo57-简单的自定义View（1）">
                基础Demo57-简单的自定义View（1） <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">QiuFeisheng</p>
              <p class="site-description motion-element" itemprop="description">Stay hungry</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">72</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、activity-guide-xml"><span class="nav-number">1.</span> <span class="nav-text">1、activity_guide.xml</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、GuideActivity-java"><span class="nav-number">2.</span> <span class="nav-text">2、GuideActivity.java</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">QiuFeisheng</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
